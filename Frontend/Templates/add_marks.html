<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Marks</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <div class="dashboard">
        <aside class="sidebar">
            <div class="sidebar-header">
                <h2>üë®‚Äçüè´ Faculty Portal</h2>
            </div>
            <nav class="sidebar-nav">
                <a href="{{ url_for('faculty_dashboard') }}" class="nav-item">
                    <span>üìä</span> Dashboard
                </a>
                <a href="{{ url_for('add_marks') }}" class="nav-item active">
                    <span>‚ûï</span> Add Marks
                </a>
                <a href="{{ url_for('logout') }}" class="nav-item">
                    <span>üö™</span> Logout
                </a>
            </nav>
            <div class="sidebar-footer">
                <p>Logged in as:<br><strong>{{ session.user_name }}</strong></p>
            </div>
        </aside>

        <main class="main-content">
            <header class="dashboard-header">
                <h1>Add Student Marks & Upload Answer Sheet</h1>
                <p>Enter marks and upload answer sheet PDF for students</p>
            </header>

            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <div class="content-section">
                <form method="POST" enctype="multipart/form-data" class="marks-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="student_id">Select Student *</label>
                            <select id="student_id" name="student_id" required>
                                <option value="">-- Select Student --</option>
                                {% for student in students %}
                                    <option value="{{ student.id }}">{{ student.name }} ({{ student.email }})</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="subject">Subject *</label>
                            <select id="subject" name="subject" required>
                                <option value="">-- Select Subject --</option>
                                <option value="AI">AI (Artificial Intelligence)</option>
                                <option value="DBMS">DBMS (Database Management Systems)</option>
                                <option value="ADS">ADS (Advanced Data Structures)</option>
                                <option value="PM">PM (Project Management)</option>
                                <option value="EDA">EDA (Exploratory Data Analysis)</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="exam">Exam Type *</label>
                            <select id="exam" name="exam" required onchange="updateMaxMarks()">
                                <option value="">-- Select Exam --</option>
                                <option value="Insem-1" data-max="20">Insem-1 (Max: 20 marks)</option>
                                <option value="Insem-2" data-max="20">Insem-2 (Max: 20 marks)</option>
                                <option value="End Sem" data-max="60">End Sem (Max: 60 marks)</option>
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="marks">Marks Obtained *</label>
                            <input type="number" id="marks" name="marks" required 
                                   min="0" max="100" placeholder="Enter marks">
                            <small class="form-hint" id="max-marks-hint">Select exam to see max marks</small>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="answer_sheet">Upload Answer Sheet PDF *</label>
                        <input type="file" id="answer_sheet" name="answer_sheet" 
                               accept=".pdf" required>
                        <small class="form-hint">üìÑ Only PDF files are allowed (Max 16MB)</small>
                    </div>

                    <div class="info-box">
                        <h4>üìã Instructions:</h4>
                        <ul>
                            <li>Select the student from the dropdown</li>
                            <li>Choose the subject and enter exam name</li>
                            <li>Enter marks obtained (0-100)</li>
                            <li>Upload the answer sheet PDF (required)</li>
                            <li>Click submit to save the record</li>
                        </ul>
                    </div>

                    <div class="form-actions">
                        <a href="{{ url_for('faculty_dashboard') }}" class="btn btn-secondary">Cancel</a>
                        <button type="submit" class="btn btn-primary">Submit Marks & Answer Sheet</button>
                    </div>
                </form>
            </div>
        </main>
    </div>

    <script src="{{ url_for('static', filename='js/script.js') }}"></script>
    <script>
        // Update max marks based on exam selection
        function updateMaxMarks() {
            const examSelect = document.getElementById('exam');
            const marksInput = document.getElementById('marks');
            const maxMarksHint = document.getElementById('max-marks-hint');
            
            const selectedOption = examSelect.options[examSelect.selectedIndex];
            const maxMarks = selectedOption.getAttribute('data-max');
            
            if (maxMarks) {
                marksInput.max = maxMarks;
                marksInput.placeholder = `Enter marks (0-${maxMarks})`;
                maxMarksHint.textContent = `üìä Maximum marks for this exam: ${maxMarks}`;
                maxMarksHint.style.color = '#2563eb';
            } else {
                marksInput.max = 100;
                marksInput.placeholder = 'Enter marks';
                maxMarksHint.textContent = 'Select exam to see max marks';
                maxMarksHint.style.color = '#666';
            }
        }
    </script>
</body>
</html>
